<template>
  <div class="d-flex vh-100 w-100">
    <!-- Left half -->
    <div
      class="flex-fill flex-column bg-primary d-none d-md-flex justify-content-center align-items-center text-white"
    >
      <h1 class="fw-bold">TIME MANAGER</h1>
      <p class="mb-0">&lt; TRINITY /&gt;</p>

      <div class="d-flex justify-content-center align-items-center h-auto w-50">
        <!-- Ton SVG inchangÃ© -->
        <svg
          viewBox="0 0 1024 1024"
          class="icon"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          fill="#000000"
        >
          <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
          <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
          <g id="SVGRepo_iconCarrier">
            <path
              d="M548.195 513.698m-251.76 0a251.76 251.76 0 1 0 503.52 0 251.76 251.76 0 1 0-503.52 0Z"
              fill="#ED8F27"
            ></path>
            <path
              d="M548.195 513.698m-204.584 0a204.584 204.584 0 1 0 409.168 0 204.584 204.584 0 1 0-409.168 0Z"
              fill="#FCE3C3"
            ></path>
            <path
              d="M549.245 737.504c-123.071 0-223.194-100.123-223.194-223.194 0-123.071 100.123-223.2 223.194-223.2 123.071 0 223.2 100.13 223.2 223.2 0.001 123.071-100.129 223.194-223.2 223.194z m0-424.602c-111.054 0-201.402 90.354-201.402 201.408s90.347 201.402 201.402 201.402 201.408-90.347 201.408-201.402-90.354-201.408-201.408-201.408z"
              fill="#300604"
            ></path>
            <path
              d="M549.245 784.679c-149.085 0-270.368-121.284-270.368-270.368s121.284-270.375 270.368-270.375S819.62 365.227 819.62 514.311 698.329 784.679 549.245 784.679z m0-518.952c-137.068 0-248.576 111.516-248.576 248.583 0 137.068 111.508 248.576 248.576 248.576 137.067 0 248.583-111.508 248.583-248.576 0-137.067-111.516-248.583-248.583-248.583z"
              fill="#300604"
            ></path>
            <path
              d="M549.245 784.679c-149.085 0-270.368-121.284-270.368-270.368s121.284-270.375 270.368-270.375S819.62 365.227 819.62 514.311 698.329 784.679 549.245 784.679z m0-518.952c-137.068 0-248.576 111.516-248.576 248.583 0 137.068 111.508 248.576 248.576 248.576 137.067 0 248.583-111.508 248.583-248.576 0-137.067-111.516-248.583-248.583-248.583zM290.873 321.06l-17.437-13.067c34.994-46.713 81.516-84.02 134.528-107.89l8.953 19.877c-49.672 22.359-93.249 57.31-126.044 101.08zM808.717 322.535c-60.66-81.941-157.661-130.86-259.472-130.86v-21.792c108.685 0 212.234 52.218 276.993 139.685l-17.521 12.967z"
              fill="#300604"
            ></path>
            <path d="M538.349 329.168h21.792v27.163h-21.792z" fill="#300604"></path>
            <path
              d="M466.097 348.541l13.584 23.523-18.87 10.897-13.583-23.523z"
              fill="#300604"
            ></path>
            <path
              d="M394.376 412.315L417.9 425.9l-10.897 18.87-23.524-13.586z"
              fill="#300604"
            ></path>
            <path d="M364.109 503.414h27.163v21.792h-27.163z" fill="#300604"></path>
            <path
              d="M406.996 583.883l10.897 18.87-23.524 13.584-10.897-18.87z"
              fill="#300604"
            ></path>
            <path
              d="M460.813 645.69l18.87 10.897-13.586 23.524-18.869-10.896z"
              fill="#300604"
            ></path>
            <path d="M538.349 672.283h21.792v27.163h-21.792z" fill="#300604"></path>
            <path
              d="M637.655 645.688l13.584 23.524-18.869 10.897-13.585-23.524z"
              fill="#300604"
            ></path>
            <path
              d="M691.533 583.876l23.523 13.585-10.896 18.869-23.524-13.584z"
              fill="#300604"
            ></path>
            <path d="M707.225 503.414h27.163v21.792h-27.163z" fill="#300604"></path>
            <path
              d="M704.148 412.324l10.896 18.87-23.523 13.584-10.896-18.87z"
              fill="#300604"
            ></path>
            <path
              d="M632.383 348.552l18.869 10.897-13.584 23.523-18.87-10.897z"
              fill="#300604"
            ></path>
            <path
              d="M517.72 588.03l-18.685-11.209 39.314-65.526V398.51h21.792v118.815z"
              fill="#300604"
            ></path>
            <path
              d="M331.228 654.924c-11.722 8.299-26.001 13.221-41.456 13.221-39.703 0-71.888-32.185-71.888-71.888s32.185-71.888 71.888-71.888c0.086 0 0.169 0.012 0.255 0.012-0.129-3.347-0.255-6.696-0.255-10.075 0-35.131 7.018-68.612 19.669-99.169-1.194-1.204-2.828-1.956-4.632-1.956h-30.074a6.542 6.542 0 0 0-6.477 5.617l-3.947 27.625c-0.393 2.753-2.495 4.911-5.216 5.487a146.275 146.275 0 0 0-38.469 13.999c-2.456 1.307-5.453 1.004-7.524-0.853l-20.776-18.622a6.542 6.542 0 0 0-8.572-0.14l-23.039 19.331a6.544 6.544 0 0 0-1.351 8.467l14.745 23.717c1.468 2.362 1.247 5.365-0.466 7.556a147.124 147.124 0 0 0-20.512 35.441c-1.043 2.575-3.53 4.266-6.307 4.175l-27.863-0.909a6.543 6.543 0 0 0-6.657 5.403l-5.222 29.617a6.542 6.542 0 0 0 4.407 7.354l26.543 8.691c2.643 0.866 4.407 3.309 4.503 6.089 0.455 13.258 2.662 26.89 6.836 40.684 0.788 2.606-0.049 5.43-2.191 7.111l-21.659 17.002a6.542 6.542 0 0 0-1.626 8.418l15.036 26.045a6.544 6.544 0 0 0 8.105 2.8l23.907-9.595c2.542-1.021 5.479-0.375 7.287 1.683a132.81 132.81 0 0 0 33.071 27.201c2.41 1.401 3.61 4.224 3.036 6.952l-5.402 25.7a6.542 6.542 0 0 0 4.165 7.494l28.261 10.286a6.543 6.543 0 0 0 8.008-3.063l13.15-24.596c1.303-2.437 3.992-3.748 6.729-3.379 14.066 1.9 27.813 1.82 41.002-0.013 2.751-0.383 5.458 0.928 6.767 3.378l13.157 24.61a6.544 6.544 0 0 0 8.009 3.063l28.26-10.286a6.542 6.542 0 0 0 4.165-7.494l-5.738-27.304c-0.572-2.717 0.66-5.46 3.012-6.934 4.536-2.842 8.851-5.994 13.037-9.299a260.63 260.63 0 0 1-49.691-56.766z"
              fill="#B12800"
            ></path>
            <path
              d="M828.102 350.896l18.972-10.716c28.714 50.816 44.182 108.407 44.738 166.543l-21.799 0.211c-0.515-54.47-15.01-108.419-41.911-156.038z"
              fill="#300604"
            ></path>
            <path
              d="M548.575 863.313c-48.041 0-94.539-9.684-138.204-28.784l8.61-19.685c40.933 17.905 84.534 26.983 129.593 26.983 80.613 0 157.852-29.814 217.489-83.952 59.229-53.767 96.333-126.999 104.48-206.208l21.373 2.197c-8.689 84.485-48.256 162.588-111.412 219.919-63.598 57.736-145.965 89.53-231.929 89.53z"
              fill="#300604"
            ></path>
          </g>
        </svg>
      </div>
    </div>

    <!-- Right half -->
    <div class="flex-fill flex-column d-flex justify-content-center align-items-center bg-light">
      <h3 class="text-center mb-4">Login into your account</h3>

      <div class="card shadow p-4" style="min-width: 320px; width: 80%; max-width: 400px;">
        <form @submit.prevent="login">
          <div class="mb-3">
            <label class="form-label" for="login-email">Email</label>
            <input
              id="login-email"
              v-model="email"
              name="email"
              type="email"
              class="form-control"
              placeholder="Enter your email"
              autocomplete="email"
              required
            />
          </div>

          <div class="mb-3">
            <label class="form-label" for="login-password">Password</label>
            <input
              id="login-password"
              v-model="password"
              name="password"
              type="password"
              class="form-control"
              placeholder="Enter your password"
              autocomplete="current-password"
              required
            />
          </div>

          <button type="submit" class="btn btn-primary w-100">Login</button>
        </form>

        <p class="text-center text-muted mt-3">{{ message }}</p>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref } from "vue"
import { useRouter } from "vue-router"
import { api } from "../services/api"

const router = useRouter()

const email = ref("")
const password = ref("")
const message = ref("")

async function login() {
  try {
    const res = await api.post("/auth/login", {
      email: email.value,
      password: password.value
    })

    localStorage.setItem("token", res.data.token)
    localStorage.setItem("user", JSON.stringify(res.data.user))

    message.value = "Login successful! Redirecting..."
    router.push("/")
  } catch (err) {
    message.value = "Invalid credentials"
  }
}
</script>
